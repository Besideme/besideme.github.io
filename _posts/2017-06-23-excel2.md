---
layout: post
title:  "EXCEL应用第二步"
date:   2017-06-23 07:35:50
categories: create post
---

### 明确目的

一切数据分析都是以业务为目的  
数据用来解决什么问题？汇总统计制作成报表？  
数据可视化，作为一张信息图？  
验证某一类业务假设？  
提高某一指标的 KPI？  

### 数据处理

**数据隐藏**  
将与此次分析无关的数据隐藏，如ID，含义重复项等  

右键 - 隐藏  

**数据有无缺失值**  
如果某一字段缺失值较多，如超过 50%，则考虑是否删除该字段，因为缺失过多就失去了业务意义

选取该列，右下角查看“计数”  

**数据是否一致化**  
一致化指的是数据是否有统一的命名标准，如“上海市”和“上海”可能表示同一个概念  

**是否有脏数据**  
乱码，错位，重复值，未匹配数据，加密数据  

**数据标准结构**  
将特殊结构的数据进行转换和规整  

例如，以数组形式存储的列，以范围存储的列，以文本形式存储的数字  

### 数据清洗  

新建 sheet，和原始数据分开  

将范围分成最高值和最低值，并以数字形式存储  
例如 7k-9k  
方法一：直接分列，以 "-" 为分隔符分成两列；替换，删除 k
方法二：文本查找的思想 'find(k,P2,1)'，函数 find 找到第一个 k 出现的位置，也即最低薪酬分割的位置，'left(P2,find(k,P2,1))' 得到 7k，'left(P2,find(k,P2,1)-1)' 得到最低薪酬 7；函数 'mid(P2,find("-",P2)-1,len(P2)-find("-",P2)-1)'得到最高薪酬 9  
在此我们用最低薪酬和最高薪酬的平均值作为平均薪酬来计算，这样计算存在问题，因为薪酬分布具有不确定性  

利用筛选功能快速定位是否有错误  

利用数据透视表对命名不一致的数据进行清洗  
单独针对需要清洗的某列建立透视表，选择要添加到报表的字段，将字段拖动到数值区域，统计各项出现的次数  
利用关键词查找的思路，找出包含特定关键词的项 'if(count(find({"关键词1","关键词2","关键词3"}，P2)),1,0)'，然后利用筛选将值为 0 的行去掉  
注意：'search' 函数在查找时支持通配符 * 和 ？，不区分大小写  

如果数据是文本格式，则偏向汇总统计的计算；如果数值型数据较多，则会涉及到统计、比例等概念；如果有时间类数据，则还会有趋势、变化的概念。  
利用数据透视表，可以先获得汇总型统计  

详细分析看此处，还需要多思考 <https://zhuanlan.zhihu.com/p/24084300>
